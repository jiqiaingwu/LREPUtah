---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# LREPUtah

<!-- badges: start -->
<!-- badges: end -->

The goal of LREPUtah is to estimate the Parameters for the Pareto Distribution and test Pareto vs. Exponential Distributions

## Installation

You can install the released version of LREPUtah from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("LREPUtah")
```

And the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("jiqiaingwu/LREPUtah")
```

## Introduction

Our test is a likelihood ratio test of the following hypotheses: 

Ho: data comes from an exponential distribution, versus the alternative

H1: data comes from a Pareto distribution.

The approach is to consider the ratio of the maxima of the likelihoods of the observed sample under the Pareto or exponential (in the numerator) and exponential (in the denominator) models. The logarithm (natural) of the likelihood ratio, the L statistic, is:

![Image of Formula1](http://www.sciweavers.org/upload/Tex2Img_1621887448/render.png)

Where <img src="http://www.sciweavers.org/tex2img.php?eq=%5Cvec%7Bx%7D&bc=White&fc=Black&im=jpg&fs=12&ff=arev&edit=0" align="center" border="0" alt="\vec{x}" width="15" height="15" /> is the observed sample of excesses and <img src="http://www.sciweavers.org/tex2img.php?eq=L_%7BPareto%7D%28%5Cvec%7Bx%7D%7C%5Calpha%2Cs%29&bc=White&fc=Black&im=jpg&fs=12&ff=arev&edit=0" align="center" border="0" alt="L_{Pareto}(\vec{x}|\alpha,s)" width="117" height="18" /> and <img src="http://www.sciweavers.org/tex2img.php?eq=L_%7Bexp%7D%28%5Cvec%7Bx%7D%7C%5Csigma%29&bc=White&fc=Black&im=jpg&fs=12&ff=arev&edit=0" align="center" border="0" alt="L_{exp}(\vec{x}|\sigma)" width="79" height="21" /> are the likelihood functions of the sample under Pareto and exponential models, respectively. 


We use a Pareto distribution with the survival function ![Image of Formula2](http://www.sciweavers.org/download/Tex2Img_1621889918.jpg) and exponential distribution with the survival function ![Image of Formula1](http://www.sciweavers.org/download/Tex2Img_1621890083.jpg). To compute L, both likelihoods are maximized first (via maximum likelihood estimates, MLEs, of the parameters), and then the natural logarithm of their ratio is taken as the likelihood ratio statistic. Panorska et al. (2007) provide the necessary theoretical results for the implementation of the numerical routines necessary for the computation of L. The properties of the test, proofs and more details on the optimization process appear separately in Kozubowski et al.(2007)

The (1-γ)100 percentiles of L provide the critical numbers for our test on the significance level γ. The test is one-sided and we reject the null hypothesis if the computed value of the test statistic exceeds the critical number. We have computed some common percentiles for the distribution of L under the null hypothesis for different sample sizes and for the limiting case. The percentiles for finite sample sizes were computed via Monte Carlo simulation with 10,000 samples of a given size from the exponential distribution (Table 1).

![Table 1](C:\Users\u0764193\Downloads\Plot.PNG)

Note: If the table didn't show up, please check the following link:
'https://drive.google.com/file/d/1TtT-9XYxvT0XoqqnmVSOJYTUnXWvSOUG/view?usp=sharing'

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(LREPUtah)

###example when data is Exponential
####################################

x<-rexp(1000,0.000000000005)
1/mean(x)
sigmaalphaLREP(x,10^-12)
expparetotest(x,0.05)

##asymptotic p-value
1/2*(1-pchisq(0,df=1))


x<-rexp(1000,0.1)
1/mean(x)
sigmaalphaLREP(x,10^-12)
expparetotest(x,0.05)

##asymptotic p-value
1/2*(1-pchisq(1.596044,df=1))


###example when data is Pareto
####################################
pareto.generation<- function(s,a,n)
{
	u<-runif(n)
	x<-s*((1-u)^(-1/a)-1)
	x
}


x<-pareto.generation(10,7,1000)
sigmaalphaLREP(x,10^-12)
expparetotest(x,0.05)

##asymptotic p-value
1/2*(1-pchisq(14.43144,df=1))
```


